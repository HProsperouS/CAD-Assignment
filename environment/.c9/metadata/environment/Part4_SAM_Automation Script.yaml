{"filter":false,"title":"Part4_SAM_Automation Script.yaml","tooltip":"/Part4_SAM_Automation Script.yaml","undoManager":{"mark":22,"position":22,"stack":[[{"start":{"row":0,"column":0},"end":{"row":245,"column":0},"action":"insert","lines":["AWSTemplateFormatVersion: '2010-09-09'","Transform: AWS::Serverless-2016-10-31","Description: CAD FoodShareHub Template","","Resources:","  MyVPC:","    Type: AWS::EC2::VPC","    Properties:","      CidrBlock: 10.0.0.0/16","      EnableDnsSupport: true","      EnableDnsHostnames: true","","  MyPublicSubnet:","    Type: AWS::EC2::Subnet","    Properties:","      VpcId: !Ref MyVPC","      CidrBlock: 10.0.1.0/24","      MapPublicIpOnLaunch: true","","  MyPrivateSubnetA:","    Type: AWS::EC2::Subnet","    Properties:","      VpcId: !Ref MyVPC","      CidrBlock: 10.0.2.0/24","","  MyPrivateSubnetB:","    Type: AWS::EC2::Subnet","    Properties:","      VpcId: !Ref MyVPC","      CidrBlock: 10.0.3.0/24","","  MyCloud9Environment:","    Type: AWS::Cloud9::EnvironmentEC2","    Properties:","      SubnetId: !Ref MyPublicSubnet","      InstanceType: t2.micro","","  MyDBSecurityGroup:","    Type: AWS::EC2::SecurityGroup","    Properties:","      GroupDescription: Security group for RDS","      VpcId: !Ref MyVPC","","  MyDBSubnetGroup:","    Type: AWS::RDS::DBSubnetGroup","    Properties:","      DBSubnetGroupDescription: Subnet Group for RDS","      SubnetIds:","        - !Ref MyPrivateSubnetA","        - !Ref MyPrivateSubnetB","","  MyRDSInstance:","    Type: AWS::RDS::DBInstance","    Properties:","      DBInstanceClass: db.t2.micro","      AllocatedStorage: 20","      Engine: mysql","      MasterUsername: admin","      MasterUserPassword: YOUR_PASSWORD","      DBSubnetGroupName: !Ref MyDBSubnetGroup","      VPCSecurityGroups:","        - !GetAtt MyDBSecurityGroup.GroupId","","  StaticWebsiteBucket:","    Type: AWS::S3::Bucket","    Properties:","      BucketName: my-static-website-bucket-name-12345","      WebsiteConfiguration:","        IndexDocument: index.html","","  StaticWebsiteBucketPolicy:","    Type: AWS::S3::BucketPolicy","    Properties:","      Bucket: !Ref StaticWebsiteBucket","      PolicyDocument:","        Version: \"2012-10-17\"","        Statement:","          - Effect: \"Allow\"","            Principal: \"*\"","            Action: \"s3:GetObject\"","            Resource: !Sub \"arn:aws:s3:::${StaticWebsiteBucket}/*\"","","  LambdaCodeBucket:","    Type: AWS::S3::Bucket","    Properties:","      BucketName: my-lambda-code-bucket-name-12345","","  LambdaCodeBucketPolicy:","    Type: AWS::S3::BucketPolicy","    Properties:","      Bucket: !Ref LambdaCodeBucket","      PolicyDocument:","        Version: \"2012-10-17\"","        Statement:","          - Effect: \"Allow\"","            Principal: \"*\"","            Action: \"s3:GetObject\"","            Resource: !Sub \"arn:aws:s3:::${LambdaCodeBucket}/*\"","          ","  LambdaExecutionRole:","    Type: AWS::IAM::Role","    Properties:","      AssumeRolePolicyDocument:","        Version: '2012-10-17'","        Statement:","          - Effect: Allow","            Principal:","              Service: lambda.amazonaws.com","            Action: sts:AssumeRole","      Policies:","        - PolicyName: LambdaServicePolicy","          PolicyDocument:","            Version: '2012-10-17'","            Statement:","              - Effect: Allow","                Action:","                  - logs:CreateLogGroup","                  - logs:CreateLogStream","                  - logs:PutLogEvents","                Resource: arn:aws:logs:*:*:*","              - Effect: Allow","                Action:","                  - rekognition:*","                Resource: \"*\"","              - Effect: Allow","                Action:","                  - sns:*","                Resource: \"*\"","","  GetCategoriesFunction:","    Type: AWS::Serverless::Function","    Properties:","      Handler: get_categories_code.lambda_handler","      Runtime: python3.11","      CodeUri: s3://my-lambda-code-bucket-name-12345/get_categories_code.zip","      Role: !GetAtt LambdaExecutionRole.Arn","","","  CreateDonationFunction:","    Type: AWS::Serverless::Function","    Properties:","      Handler: create_donation_code.lambda_handler","      Runtime: python3.11","      CodeUri: s3://my-lambda-code-bucket-name-12345/create_donation_code.zip","      Role: !GetAtt LambdaExecutionRole.Arn","","","  GetDonationsFunction:","    Type: AWS::Serverless::Function","    Properties:","      Handler: get_donations_code.lambda_handler","      Runtime: python3.11","      CodeUri: s3://my-lambda-code-bucket-name-12345/get_donations_code.zip","      Role: !GetAtt LambdaExecutionRole.Arn","","","  SendNotificationFunction:","    Type: AWS::Serverless::Function","    Properties:","      Handler: send_notification_code.lambda_handler","      Runtime: python3.11","      CodeUri: s3://my-lambda-code-bucket-name-12345/send_notification_code.zip","      Role: !GetAtt LambdaExecutionRole.Arn","","  SubscribeNotificationFunction:","    Type: AWS::Serverless::Function","    Properties:","      Handler: subscribe_notification_code.lambda_handler","      Runtime: python3.11","      CodeUri: s3://my-lambda-code-bucket-name-12345/subscribe_notification_code.zip","      Role: !GetAtt LambdaExecutionRole.Arn","","  DetectImageFunction:","    Type: AWS::Serverless::Function","    Properties:","      Handler: detect_image_code.lambda_handler","      Runtime: python3.11","      CodeUri: s3://my-lambda-code-bucket-name-12345/detect_image_code.zip","      Role: !GetAtt LambdaExecutionRole.Arn","","  MyApi:","    Type: AWS::Serverless::Api","    Properties:","      StageName: Prod","      DefinitionBody:","        swagger: \"2.0\"","        info:","          title: \"FoodShareHubApi\"","        paths:","          /categories:","            get:","              x-amazon-apigateway-integration:","                uri: ","                  Fn::Sub: \"arn:aws:apigateway:ap-southeast-1:lambda:path/2024-02-08/functions/${GetCategoriesFunction.Arn}/invocations\"","                httpMethod: POST","                type: aws_proxy","            options:","              responses: {}","","          /donations:","            get:","              x-amazon-apigateway-integration:","                uri:","                  Fn::Sub: \"arn:aws:apigateway:ap-southeast-1:lambda:path/2024-02-08/functions/${GetDonationsFunction.Arn}/invocations\"","                httpMethod: POST","                type: aws_proxy","            post:","              x-amazon-apigateway-integration:","                uri:","                  Fn::Sub: \"arn:aws:apigateway:ap-southeast-1:lambda:path/2024-02-08/functions/${CreateDonationFunction.Arn}/invocations\"","                httpMethod: POST","                type: aws_proxy","            options:","              responses: {}","","          /notification:","            post:","              x-amazon-apigateway-integration:","                uri:","                  Fn::Sub: \"arn:aws:apigateway:ap-southeast-1:lambda:path/2024-02-08/functions/${SendNotificationFunction.Arn}/invocations\"","                httpMethod: POST","                type: aws_proxy","            options:","              responses: {}","","          /recognition:","            post:","              x-amazon-apigateway-integration:","                uri:","                  Fn::Sub: \"arn:aws:apigateway:ap-southeast-1:lambda:path/2024-02-08/functions/${DetectImageFunction.Arn}/invocations\"","                httpMethod: POST","                type: aws_proxy","            options:","              responses: {}","","          /subscribe_notification:","            post:","              x-amazon-apigateway-integration:","                uri:","                  Fn::Sub: \"arn:aws:apigateway:ap-southeast-1:lambda:path/2024-02-08/functions/${SubscribeNotificationFunction.Arn}/invocations\"","                httpMethod: POST","                type: aws_proxy","            options:","              responses: {}","",""],"id":1}],[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"insert","lines":["",""],"id":2},{"start":{"row":1,"column":0},"end":{"row":2,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":0,"column":0},"end":{"row":0,"column":1},"action":"insert","lines":["#"],"id":3}],[{"start":{"row":0,"column":1},"end":{"row":0,"column":2},"action":"insert","lines":[" "],"id":4}],[{"start":{"row":0,"column":2},"end":{"row":0,"column":6},"action":"insert","lines":["Name"],"id":5},{"start":{"row":0,"column":6},"end":{"row":0,"column":7},"action":"insert","lines":[":"]}],[{"start":{"row":0,"column":7},"end":{"row":0,"column":8},"action":"insert","lines":[" "],"id":6},{"start":{"row":0,"column":8},"end":{"row":0,"column":9},"action":"insert","lines":["2"]},{"start":{"row":0,"column":9},"end":{"row":0,"column":10},"action":"insert","lines":["1"]},{"start":{"row":0,"column":10},"end":{"row":0,"column":11},"action":"insert","lines":["1"]},{"start":{"row":0,"column":11},"end":{"row":0,"column":12},"action":"insert","lines":["2"]},{"start":{"row":0,"column":12},"end":{"row":0,"column":13},"action":"insert","lines":["8"]},{"start":{"row":0,"column":13},"end":{"row":0,"column":14},"action":"insert","lines":["3"]},{"start":{"row":0,"column":14},"end":{"row":0,"column":15},"action":"insert","lines":["E"]}],[{"start":{"row":0,"column":15},"end":{"row":1,"column":0},"action":"insert","lines":["",""],"id":7}],[{"start":{"row":0,"column":15},"end":{"row":1,"column":0},"action":"remove","lines":["",""],"id":8},{"start":{"row":0,"column":14},"end":{"row":0,"column":15},"action":"remove","lines":["E"]},{"start":{"row":0,"column":13},"end":{"row":0,"column":14},"action":"remove","lines":["3"]},{"start":{"row":0,"column":12},"end":{"row":0,"column":13},"action":"remove","lines":["8"]},{"start":{"row":0,"column":11},"end":{"row":0,"column":12},"action":"remove","lines":["2"]},{"start":{"row":0,"column":10},"end":{"row":0,"column":11},"action":"remove","lines":["1"]},{"start":{"row":0,"column":9},"end":{"row":0,"column":10},"action":"remove","lines":["1"]},{"start":{"row":0,"column":8},"end":{"row":0,"column":9},"action":"remove","lines":["2"]}],[{"start":{"row":0,"column":8},"end":{"row":0,"column":9},"action":"insert","lines":["L"],"id":9},{"start":{"row":0,"column":9},"end":{"row":0,"column":10},"action":"insert","lines":["i"]},{"start":{"row":0,"column":10},"end":{"row":0,"column":11},"action":"insert","lines":["u"]}],[{"start":{"row":0,"column":11},"end":{"row":0,"column":12},"action":"insert","lines":[" "],"id":10},{"start":{"row":0,"column":12},"end":{"row":0,"column":13},"action":"insert","lines":["J"]},{"start":{"row":0,"column":13},"end":{"row":0,"column":14},"action":"insert","lines":["i"]},{"start":{"row":0,"column":14},"end":{"row":0,"column":15},"action":"insert","lines":["a"]},{"start":{"row":0,"column":15},"end":{"row":0,"column":16},"action":"insert","lines":["J"]},{"start":{"row":0,"column":16},"end":{"row":0,"column":17},"action":"insert","lines":["u"]},{"start":{"row":0,"column":17},"end":{"row":0,"column":18},"action":"insert","lines":["n"]}],[{"start":{"row":0,"column":18},"end":{"row":1,"column":0},"action":"insert","lines":["",""],"id":11},{"start":{"row":1,"column":0},"end":{"row":1,"column":1},"action":"insert","lines":["#"]}],[{"start":{"row":1,"column":1},"end":{"row":1,"column":2},"action":"insert","lines":[" "],"id":12}],[{"start":{"row":1,"column":2},"end":{"row":1,"column":3},"action":"insert","lines":["A"],"id":13},{"start":{"row":1,"column":3},"end":{"row":1,"column":4},"action":"insert","lines":["d"]}],[{"start":{"row":1,"column":3},"end":{"row":1,"column":4},"action":"remove","lines":["d"],"id":14},{"start":{"row":1,"column":2},"end":{"row":1,"column":3},"action":"remove","lines":["A"]}],[{"start":{"row":1,"column":2},"end":{"row":1,"column":3},"action":"insert","lines":["S"],"id":15},{"start":{"row":1,"column":3},"end":{"row":1,"column":4},"action":"insert","lines":["t"]},{"start":{"row":1,"column":4},"end":{"row":1,"column":5},"action":"insert","lines":["u"]},{"start":{"row":1,"column":5},"end":{"row":1,"column":6},"action":"insert","lines":["d"]},{"start":{"row":1,"column":6},"end":{"row":1,"column":7},"action":"insert","lines":["e"]},{"start":{"row":1,"column":7},"end":{"row":1,"column":8},"action":"insert","lines":["n"]},{"start":{"row":1,"column":8},"end":{"row":1,"column":9},"action":"insert","lines":["t"]}],[{"start":{"row":1,"column":9},"end":{"row":1,"column":10},"action":"insert","lines":[" "],"id":16},{"start":{"row":1,"column":10},"end":{"row":1,"column":11},"action":"insert","lines":["I"]},{"start":{"row":1,"column":11},"end":{"row":1,"column":12},"action":"insert","lines":["F"]}],[{"start":{"row":1,"column":11},"end":{"row":1,"column":12},"action":"remove","lines":["F"],"id":17}],[{"start":{"row":1,"column":11},"end":{"row":1,"column":12},"action":"insert","lines":["D"],"id":18}],[{"start":{"row":0,"column":2},"end":{"row":0,"column":3},"action":"insert","lines":["S"],"id":19},{"start":{"row":0,"column":3},"end":{"row":0,"column":4},"action":"insert","lines":["t"]},{"start":{"row":0,"column":4},"end":{"row":0,"column":5},"action":"insert","lines":["u"]},{"start":{"row":0,"column":5},"end":{"row":0,"column":6},"action":"insert","lines":["d"]},{"start":{"row":0,"column":6},"end":{"row":0,"column":7},"action":"insert","lines":["e"]},{"start":{"row":0,"column":7},"end":{"row":0,"column":8},"action":"insert","lines":["n"]},{"start":{"row":0,"column":8},"end":{"row":0,"column":9},"action":"insert","lines":["t"]}],[{"start":{"row":0,"column":9},"end":{"row":0,"column":10},"action":"insert","lines":[" "],"id":20}],[{"start":{"row":1,"column":12},"end":{"row":1,"column":13},"action":"insert","lines":[":"],"id":21}],[{"start":{"row":1,"column":13},"end":{"row":1,"column":14},"action":"insert","lines":[" "],"id":22}],[{"start":{"row":1,"column":14},"end":{"row":1,"column":15},"action":"insert","lines":["2"],"id":23},{"start":{"row":1,"column":15},"end":{"row":1,"column":16},"action":"insert","lines":["1"]},{"start":{"row":1,"column":16},"end":{"row":1,"column":17},"action":"insert","lines":["1"]},{"start":{"row":1,"column":17},"end":{"row":1,"column":18},"action":"insert","lines":["2"]},{"start":{"row":1,"column":18},"end":{"row":1,"column":19},"action":"insert","lines":["8"]},{"start":{"row":1,"column":19},"end":{"row":1,"column":20},"action":"insert","lines":["3"]},{"start":{"row":1,"column":20},"end":{"row":1,"column":21},"action":"insert","lines":["E"]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":8,"column":8},"end":{"row":8,"column":8},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1707400244341,"hash":"2387ffbbb1d2db132be525fcd05eaf54ca1d4e0c"}